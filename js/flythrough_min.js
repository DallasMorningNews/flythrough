!function(e){e.fn.flythrough=function(t){function r(e){u.children(".flyButton").unbind("click"),e.hasClass("play")===!0?(h++,a(),n()):(h--,a(),l())}function a(){0===h?u.children(".rewind").hide():h===o.frames.length-1?u.children(".play").hide():u.children(".flyButton").show()}function n(){"waypoint"===o.frames[h].type&&(u.children(".overlay").fadeOut(250),u.children(".label").remove(),u.children(".satCredit").text(o.frames[h].satCredit),m[0].play()),f()}function i(){m[0].currentTime>=o.frames[h].end&&m[0].paused!==!0&&(m[0].pause(),d(),c(),s())}function l(){"waypoint"===o.frames[h].type&&(u.children(".overlay").fadeOut(250),u.children(".label").remove(),u.children(".satCredit").text(o.frames[h].satCredit),d(),c(),m[0].currentTime=o.frames[h].end,s()),f()}function s(){u.children(".flyButton").bind("click",function(){return r(e(this))})}function d(){void 0!==o.frames[h].overlayHead&&u.children(".textOverlay h4").html(o.frames[h].overlayHead),void 0!==o.frames[h].overlayText&&u.children(".textOverlay p").html(o.frames[h].overlayText),(void 0!==o.frames[h].overlayHead||void 0!==o.frames[h].overlayText)&&u.children(".textOverlay").fadeIn(250)}function c(){void 0!==o.frames[h].labels&&e.each(o.frames[h].labels,function(e,t){var r="";r+="<span class='label' style='top: "+o.frames[h].labels[e].y+"; left: "+o.frames[h].labels[e].x+";'>",r+=o.frames[h].labels[e].text,r+="</span>",u.children(".flythrough").append(r)})}function f(){"image"===o.frames[h].type&&(u.children(".overlay").fadeOut(250),u.children(".label").remove(),u.children(".imageOverlay img").attr("src",o.frames[h].imagePath).attr("alt",o.frames[h].cutline),void 0!==o.frames[h].cutline&&u.children(".imageOverlay .cutline").html(o.frames[h].cutline),u.children(".imageOverlay").fadeIn(250),m[0].currentTime=o.frames[h].end,s())}var o=e.extend({frames:[]},t);0===frames.length&&console.error("Frames must be an array with at least one object.");var m=this.children(".flyVideo"),h=0,u=this;return a(),m[0].controls=!1,m[0].addEventListener("timeupdate",i,!1),this.children(".flyButton").bind("click",function(){return r(e(this))}),this.find(".titleButton").click(function(){e(".titleCard").remove(),m[0].currentTime=o.frames[h].end,void 0!==o.frames[h].satCredit&&u.children(".satCredit").text(o.frames[h].satCredit),d(),c(),f()}),this}}(jQuery);
